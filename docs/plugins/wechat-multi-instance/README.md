# 微信创建副本插件使用指南

## 📱 功能特性

微信创建副本插件允许你在macOS上创建和管理微信应用的独立副本,每个副本独立运行,互不干扰。

**注意**: 本插件仅用于创建微信应用的独立副本供个人使用,请遵守微信用户协议。

### 主要功能

- ✅ **一键创建副本** - 自动复制并配置微信应用
- ✅ **多副本管理** - 支持创建多个副本,独立运行
- ✅ **状态监控** - 实时显示每个副本的运行状态
- ✅ **自动签名** - 使用codesign自动签名副本应用
- ✅ **安全隔离** - 每个副本有独立的Bundle ID和数据目录
- ✅ **批量操作** - 支持批量启动、停止副本

## 🔧 系统要求

- **操作系统**: macOS 10.15+ (Catalina或更高版本)
- **微信版本**: 最新版微信(从App Store安装)
- **权限要求**:
  - 管理员权限 (用于创建副本和签名)
  - 文件系统读写权限
  - 进程管理权限

## 📥 安装和配置

### 1. 安装插件

1. 打开 RokunTool 应用
2. 进入插件市场
3. 找到"微信创建副本"插件
4. 点击"安装"按钮

### 2. 首次配置

首次使用时,插件会自动:

1. 检测 `/Applications/WeChat.app` 是否存在
2. 检查系统权限
3. 创建配置目录 `~/Library/Application Support/RokunTool/plugins/wechat-multi-instance`

### 3. 权限设置

插件需要以下权限,首次使用时会自动请求:

- **文件系统访问**: 读取和复制微信应用
- **进程管理**: 启动和停止微信实例
- **Shell执行**: 执行签名和系统命令
- **通知显示**: 显示操作结果提示

## 🚀 使用指南

### 创建第一个副本

1. **打开插件**
   - 在 RokunTool 中进入"微信创建副本"插件页面

2. **检测微信应用**
   - 插件会自动检测系统是否已安装微信
   - 如果未安装,请先从App Store安装微信

3. **创建副本**
   - 点击"创建新副本"按钮
   - 输入副本名称(例如: "工作号"、"小号")
   - 确认创建

4. **等待处理**
   - 插件会自动:
     - 复制微信应用到 `/Applications/WeChat-副本名.app`
     - 修改Bundle ID
     - 重新签名应用
     - 保存配置

5. **完成**
   - 创建成功后会显示通知
   - 副本会出现在实例列表中

### 管理副本

#### 启动副本

1. 在实例列表中找到要启动的副本
2. 点击"启动"按钮
3. 等待副本启动完成
4. 副本图标会显示为"运行中"状态

#### 停止副本

1. 在实例列表中找到要停止的副本
2. 点击"停止"按钮
3. 确认停止操作
4. 副本会安全退出

#### 删除副本

1. 在实例列表中找到要删除的副本
2. 点击"删除"按钮
3. 确认删除操作
4. 副本应用会被完全移除

### 实例状态说明

- **🟢 运行中** - 副本正在使用
- **⚪ 已停止** - 副本未运行
- **🔴 错误** - 副本配置或运行出现问题

## 🔍 常见问题解答

### Q1: 创建副本时提示"权限不足"?

**A**: 需要管理员权限。请确保:
1. 你的账户有管理员权限
2. 在弹出的权限请求对话框中点击"允许"
3. 如果仍然失败,尝试使用 `sudo` 命令手动启动应用

### Q2: 副本创建后无法启动?

**A**: 可能的原因和解决方案:
1. **签名问题** - 重新签名副本应用
2. **Bundle ID冲突** - 删除副本后重新创建
3. **微信更新** - 微信更新后需要重新创建副本
4. **系统版本不兼容** - 检查macOS版本是否满足要求

### Q3: 副本可以和原版微信同时使用吗?

**A**: 可以!每个副本都有独立的:
- Bundle ID
- 数据目录
- 进程空间
- 用户数据

它们互不干扰,可以同时登录不同的微信账号。

### Q4: 微信更新后副本还能用吗?

**A**: 微信更新后,副本可能需要重建:
1. 插件会自动检测版本不匹配
2. 点击"重建副本"按钮
3. 重新创建副本即可
4. 旧副本的聊天记录会保留

### Q5: 如何备份数据?

**A**: 副本数据存储位置:
```
~/Library/Containers/com.tencent.xin{副本后缀}/
~/Library/Group Containers/{群组ID}/
```

备份方法:
1. 使用Time Machine自动备份
2. 手动复制上述目录
3. 使用插件导出功能(开发中)

### Q6: 副本会影响原版微信吗?

**A**: 不会。副本是独立的应用:
- 独立的安装位置
- 独立的数据目录
- 独立的Bundle ID
- 互不影响

### Q7: 可以创建多少个副本?

**A**: 理论上没有限制,但建议:
- 一般用户: 2-3个副本
- 需求较多: 最多5个副本
- 过多副本可能影响系统性能

### Q8: 副本占用多少磁盘空间?

**A**: 每个副本约:
- 应用大小: ~200MB
- 数据大小: 根据使用情况,通常1-5GB
- 总计: 约2-5GB

## 🛠️ 故障排除指南

### 问题1: 创建副本失败

**症状**: 点击创建后提示错误

**排查步骤**:
1. 检查 `/Applications/WeChat.app` 是否存在
2. 确认磁盘空间充足(至少5GB)
3. 检查是否有管理员权限
4. 查看日志: `~/Library/Logs/RokunTool/wechat-multi-instance.log`

**解决方案**:
```bash
# 手动检查微信应用
ls -la /Applications/WeChat.app

# 检查磁盘空间
df -h

# 查看日志
cat ~/Library/Logs/RokunTool/wechat-multi-instance.log
```

### 问题2: 副本启动崩溃

**症状**: 启动副本后立即退出

**可能原因**:
1. 签名失效
2. 数据目录损坏
3. 系统兼容性问题

**解决方案**:
```bash
# 重新签名
sudo codesign --force --deep --sign - /Applications/WeChat-{副本名}.app

# 清理缓存
rm -rf ~/Library/Caches/com.tencent.xin{副本后缀}

# 重启系统
sudo reboot
```

### 问题3: 副本无法登录

**症状**: 副本启动但无法登录微信

**排查步骤**:
1. 检查网络连接
2. 确认微信账号正常
3. 尝试重启副本
4. 查看系统日志

**解决方案**:
1. 退出副本后重新登录
2. 删除副本后重新创建
3. 联系微信客服确认账号状态

### 问题4: 性能问题

**症状**: 多个副本运行时卡顿

**优化建议**:
1. 关闭不需要的副本
2. 重启电脑
3. 清理系统缓存
4. 升级硬件配置

**清理命令**:
```bash
# 清理缓存
sudo rm -rf /System/Volumes/Data/private/var/folders/*
sudo rm -rf ~/Library/Caches/*

# 重启
sudo reboot
```

## 📞 技术支持

### 获取帮助

- **文档**: 查看本README和`TECHNICAL.md`技术文档
- **日志位置**: `~/Library/Logs/RokunTool/wechat-multi-instance.log`
- **配置文件**: `~/Library/Application Support/RokunTool/plugins/wechat-multi-instance/instances.json`

### 反馈问题

遇到问题?请提供以下信息:
1. macOS版本
2. 微信版本
3. 插件版本
4. 错误截图
5. 日志文件

### 免责声明

本插件仅供学习和个人使用。请遵守微信用户协议,不得用于商业用途。使用本插件产生的任何问题,作者不承担责任。

## 📄 许可证

MIT License - 详见项目根目录的LICENSE文件

## 🙏 致谢

感谢以下项目和资源:
- [WeChat](https://weixin.qq.com/) - 微信官方应用
- Electron社区 - 提供跨平台框架支持
- Rime输入法社区 - 输入法方案参考

---

**最后更新**: 2026-01-10
**版本**: 1.0.0
**作者**: Rokun
