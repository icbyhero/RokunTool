# RokunTool æ’ä»¶å®‰è£…æŒ‡å—

**æ›´æ–°æ—¥æœŸ**: 2026-01-11
**é€‚ç”¨äº**: RokunTool v1.0.0+

---

## ğŸ“¦ å½“å‰æ’ä»¶å®‰è£…æœºåˆ¶

### ğŸ¯ æ ¸å¿ƒåŸç†

RokunTool ä½¿ç”¨**æœ¬åœ°ç›®å½•æ‰«æ**çš„æ–¹å¼è‡ªåŠ¨åŠ è½½æ’ä»¶:

1. **æ’ä»¶ç›®å½•ä½ç½®**: `rokun-tool/plugins/`
2. **è‡ªåŠ¨åŠ è½½**: åº”ç”¨å¯åŠ¨æ—¶è‡ªåŠ¨æ‰«æå¹¶åŠ è½½æ‰€æœ‰æ’ä»¶
3. **æ— éœ€æ‰‹åŠ¨å®‰è£…**: åªéœ€å°†æ’ä»¶æ”¾å…¥ `plugins/` ç›®å½•å³å¯

---

## ğŸ”§ å¦‚ä½•æ·»åŠ æ–°æ’ä»¶

### æ–¹æ³• 1: ç›´æ¥å¤åˆ¶æ’ä»¶æ–‡ä»¶å¤¹ (æ¨è)

è¿™æ˜¯æœ€ç®€å•ç›´æ¥çš„æ–¹æ³•:

```bash
# 1. å°†æ’ä»¶æ–‡ä»¶å¤¹å¤åˆ¶åˆ° plugins ç›®å½•
cp -r /path/to/your-plugin rokun-tool/plugins/

# 2. é‡å¯åº”ç”¨,æ’ä»¶ä¼šè‡ªåŠ¨åŠ è½½
pnpm dev
```

**ç¤ºä¾‹**:
```bash
# å¦‚æœæ‚¨æœ‰ä¸€ä¸ªåä¸º "my-tool" çš„æ’ä»¶
cp -r ~/Downloads/my-tool rokun-tool/plugins/

# é‡å¯åº”ç”¨
cd rokun-tool
pnpm dev
```

---

### æ–¹æ³• 2: Git å…‹éš†æ’ä»¶

å¦‚æœæ’ä»¶æ‰˜ç®¡åœ¨ Git ä»“åº“ä¸­:

```bash
# 1. å…‹éš†æ’ä»¶åˆ° plugins ç›®å½•
cd rokun-tool/plugins
git clone https://github.com/username/plugin-repo.git

# 2. é‡å¯åº”ç”¨
cd ..
pnpm dev
```

**ç¤ºä¾‹**:
```bash
# å…‹éš†ä¸€ä¸ªç¤ºä¾‹æ’ä»¶
cd rokun-tool/plugins
git clone https://github.com/example/rime-plugin.git

# é‡å¯åº”ç”¨
cd ..
pnpm dev
```

---

### æ–¹æ³• 3: æ‰‹åŠ¨åˆ›å»ºæ’ä»¶

ä»é›¶å¼€å§‹åˆ›å»ºè‡ªå·±çš„æ’ä»¶:

```bash
# 1. åˆ›å»ºæ’ä»¶ç›®å½•
mkdir rokun-tool/plugins/my-plugin
cd rokun-tool/plugins/my-plugin

# 2. åˆ›å»º package.json (å¿…éœ€)
# 3. åˆ›å»º index.js (æ’ä»¶å…¥å£)
# 4. åˆ›å»ºå…¶ä»–å¿…éœ€æ–‡ä»¶
```

è¯¦è§ä¸‹é¢çš„"æ’ä»¶å¼€å‘"éƒ¨åˆ†ã€‚

---

## ğŸ“‹ æ’ä»¶ç›®å½•ç»“æ„

ä¸€ä¸ªæ ‡å‡†çš„æ’ä»¶åº”è¯¥åŒ…å«ä»¥ä¸‹æ–‡ä»¶:

```
my-plugin/
â”œâ”€â”€ package.json          # æ’ä»¶å…ƒæ•°æ® (å¿…éœ€)
â”œâ”€â”€ index.js              # æ’ä»¶å…¥å£æ–‡ä»¶ (å¿…éœ€)
â”œâ”€â”€ icon.png              # æ’ä»¶å›¾æ ‡ (å¯é€‰)
â”œâ”€â”€ README.md             # æ’ä»¶è¯´æ˜ (å¯é€‰)
â””â”€â”€ data/                 # æ’ä»¶æ•°æ®ç›®å½• (è‡ªåŠ¨åˆ›å»º)
```

---

## ğŸ“ package.json å¿…éœ€å­—æ®µ

æ¯ä¸ªæ’ä»¶**å¿…é¡»**åŒ…å«ä»¥ä¸‹å­—æ®µ:

```json
{
  "name": "my-plugin",
  "version": "1.0.0",
  "description": "æ’ä»¶æè¿°",
  "author": "ä½œè€…åç§°",
  "license": "MIT",
  "main": "index.js",

  // RokunTool ç‰¹å®šå­—æ®µ (å¿…éœ€)
  "rokun": {
    "id": "my-plugin",                    // æ’ä»¶å”¯ä¸€ID (å°å†™å­—æ¯ã€æ•°å­—ã€è¿å­—ç¬¦)
    "name": "æˆ‘çš„æ’ä»¶",                   // æ˜¾ç¤ºåç§°
    "version": "1.0.0",                  // ç‰ˆæœ¬å·
    "description": "æ’ä»¶åŠŸèƒ½æè¿°",        // è¯¦ç»†æè¿°
    "author": "ä½œè€…",                    // ä½œè€…
    "license": "MIT",                    // è®¸å¯è¯
    "permissions": [                     // éœ€è¦çš„æƒé™åˆ—è¡¨
      "fs:read",
      "fs:write"
    ]
  }
}
```

### æ”¯æŒçš„æƒé™åˆ—è¡¨

| æƒé™ | è¯´æ˜ |
|------|------|
| `fs:read` | è¯»å–æ–‡ä»¶ |
| `fs:write` | å†™å…¥æ–‡ä»¶ |
| `process:spawn` | å¯åŠ¨è¿›ç¨‹ |
| `process:exec` | æ‰§è¡Œå‘½ä»¤ |
| `shell:execute` | æ‰§è¡ŒShellå‘½ä»¤ |
| `network:http` | HTTPç½‘ç»œè¯·æ±‚ |
| `notification:show` | æ˜¾ç¤ºé€šçŸ¥ |
| `clipboard:read` | è¯»å–å‰ªè´´æ¿ |
| `clipboard:write` | å†™å…¥å‰ªè´´æ¿ |
| `config:read` | è¯»å–é…ç½® |
| `config:write` | å†™å…¥é…ç½® |

---

## ğŸ” æ’ä»¶åŠ è½½æµç¨‹

### è‡ªåŠ¨åŠ è½½æ—¶æœº

åº”ç”¨å¯åŠ¨æ—¶ä¼šè‡ªåŠ¨æ‰§è¡Œä»¥ä¸‹æ­¥éª¤:

1. **æ‰«ææ’ä»¶ç›®å½•** (`plugins/`)
2. **è¯»å–** `package.json`
3. **éªŒè¯æ’ä»¶å…ƒæ•°æ®**
   - æ£€æŸ¥å¿…éœ€å­—æ®µ
   - éªŒè¯æ’ä»¶IDæ ¼å¼
   - éªŒè¯ç‰ˆæœ¬å·æ ¼å¼
4. **æˆäºˆæ’ä»¶å£°æ˜çš„æƒé™**
5. **åŠ è½½æ’ä»¶å…¥å£æ–‡ä»¶** (`index.js`)
6. **è°ƒç”¨æ’ä»¶çš„ `onLoad` é’©å­**
7. **å¯ç”¨æ’ä»¶** (å¦‚æœ `enabled` ä¸ä¸º `false`)
8. **è°ƒç”¨æ’ä»¶çš„ `onEnable` é’©å­**

### ä»£ç ç¤ºä¾‹

```typescript
// ä¸»è¿›ç¨‹å¯åŠ¨æ—¶
const pluginsDir = join(__dirname, '../../plugins')
const pluginLoader = new PluginLoader(pluginsDir, pluginRegistry, serviceManager)

// å¼‚æ­¥åŠ è½½æ‰€æœ‰æ’ä»¶
setImmediate(async () => {
  const plugins = await pluginLoader.loadAll({ autoEnable: true })
  console.log(`Loaded ${plugins.length} plugin(s)`)
})
```

---

## ğŸ“¦ ç°æœ‰æ’ä»¶ç¤ºä¾‹

### 1. Rime é…ç½®ç®¡ç†æ’ä»¶

**ä½ç½®**: `plugins/rime-config/`

**package.json**:
```json
{
  "rokun": {
    "id": "rokun-rime-config",
    "name": "Rime é…ç½®ç®¡ç†",
    "permissions": [
      "fs:read",
      "fs:write",
      "process:spawn",
      "process:exec",
      "shell:execute",
      "network:http",
      "notification:show"
    ]
  }
}
```

### 2. å¾®ä¿¡åˆ†èº«æ’ä»¶

**ä½ç½®**: `plugins/wechat-multi-instance/`

**package.json**:
```json
{
  "rokun": {
    "id": "rokun-wechat-multi",
    "name": "å¾®ä¿¡åˆ†èº«",
    "permissions": [
      "fs:read",
      "fs:write",
      "process:spawn",
      "process:exec",
      "shell:execute",
      "notification:show"
    ]
  }
}
```

---

## ğŸ› ï¸ æ’ä»¶å¼€å‘å¿«é€Ÿå¼€å§‹

### æœ€å°åŒ–æ’ä»¶ç¤ºä¾‹

**1. åˆ›å»ºæ’ä»¶ç›®å½•**:
```bash
mkdir rokun-tool/plugins/hello-world
cd rokun-tool/plugins/hello-world
```

**2. åˆ›å»º package.json**:
```json
{
  "name": "hello-world",
  "version": "1.0.0",
  "description": "Hello World æ’ä»¶",
  "author": "Your Name",
  "license": "MIT",
  "main": "index.js",
  "rokun": {
    "id": "hello-world",
    "name": "Hello World",
    "version": "1.0.0",
    "description": "æˆ‘çš„ç¬¬ä¸€ä¸ªæ’ä»¶",
    "author": "Your Name",
    "license": "MIT",
    "permissions": [
      "notification:show"
    ]
  }
}
```

**3. åˆ›å»º index.js**:
```javascript
// æ’ä»¶é’©å­å‡½æ•°
async function onLoad(context) {
  context.logger.info('Hello World æ’ä»¶å·²åŠ è½½!')
}

async function onEnable(context) {
  context.logger.info('Hello World æ’ä»¶å·²å¯ç”¨!')
  context.api.notification.show({
    title: 'Hello World',
    body: 'æˆ‘çš„ç¬¬ä¸€ä¸ªæ’ä»¶å·²å¯ç”¨!'
  })
}

async function onDisable(context) {
  context.logger.info('Hello World æ’ä»¶å·²ç¦ç”¨')
}

async function onUnload(context) {
  context.logger.info('Hello World æ’ä»¶å·²å¸è½½')
}
```

**4. é‡å¯åº”ç”¨**:
```bash
cd rokun-tool
pnpm dev
```

---

## âš ï¸ å¸¸è§é—®é¢˜

### 1. æ’ä»¶æ²¡æœ‰è¢«åŠ è½½

**å¯èƒ½åŸå› **:
- âœ… `package.json` ç¼ºå°‘å¿…éœ€å­—æ®µ
- âœ… æ’ä»¶IDæ ¼å¼ä¸æ­£ç¡® (åªå…è®¸å°å†™å­—æ¯ã€æ•°å­—å’Œè¿å­—ç¬¦)
- âœ… ç‰ˆæœ¬å·æ ¼å¼ä¸æ­£ç¡® (å¿…é¡»æ˜¯ `x.y.z` æ ¼å¼)
- âœ… æ’ä»¶å…¥å£æ–‡ä»¶ä¸å­˜åœ¨

**è§£å†³æ–¹æ³•**: æ£€æŸ¥æ§åˆ¶å°æ—¥å¿—,æŸ¥çœ‹å…·ä½“çš„é”™è¯¯ä¿¡æ¯

### 2. æƒé™è¢«æ‹’ç»

**å¯èƒ½åŸå› **: æ’ä»¶è¯·æ±‚çš„æƒé™æ²¡æœ‰åœ¨ `permissions` ä¸­å£°æ˜

**è§£å†³æ–¹æ³•**: åœ¨ `package.json` çš„ `rokun.permissions` ä¸­æ·»åŠ æ‰€éœ€æƒé™

### 3. æ’ä»¶åŠ è½½å¤±è´¥

**æ£€æŸ¥æ­¥éª¤**:
1. ç¡®è®¤æ’ä»¶ç›®å½•åœ¨ `plugins/` æ–‡ä»¶å¤¹ä¸‹
2. ç¡®è®¤ `package.json` æ ¼å¼æ­£ç¡®
3. ç¡®è®¤ `index.js` æ–‡ä»¶å­˜åœ¨
4. æŸ¥çœ‹å¼€å‘è€…æ§åˆ¶å°çš„é”™è¯¯æ—¥å¿—

---

## ğŸ¯ æœ€ä½³å®è·µ

### 1. æ’ä»¶IDå‘½åè§„èŒƒ

```json
{
  "rokun": {
    "id": "my-plugin",           // âœ… æ­£ç¡®: å°å†™å­—æ¯å’Œè¿å­—ç¬¦
    "id": "MyPlugin",           // âŒ é”™è¯¯: åŒ…å«å¤§å†™å­—æ¯
    "id": "my_plugin",          // âŒ é”™è¯¯: åŒ…å«ä¸‹åˆ’çº¿
    "id": "my.plugin",          // âŒ é”™è¯¯: åŒ…å«ç‚¹å·
    "id": "my-plugin-v2"        // âœ… æ­£ç¡®: å°å†™å­—æ¯ã€æ•°å­—å’Œè¿å­—ç¬¦
  }
}
```

### 2. æƒé™æœ€å°åŒ–åŸåˆ™

åªå£°æ˜æ’ä»¶å®é™…éœ€è¦çš„æƒé™:
```json
{
  "rokun": {
    "permissions": [
      "fs:read",        // âœ… åªè¯»æ–‡ä»¶
      "notification:show"  // âœ… æ˜¾ç¤ºé€šçŸ¥
      // âŒ ä¸è¦æ·»åŠ ä¸éœ€è¦çš„æƒé™
    ]
  }
}
```

### 3. æ’ä»¶æ–‡ä»¶ç»„ç»‡

```
my-plugin/
â”œâ”€â”€ package.json       # å…ƒæ•°æ®
â”œâ”€â”€ index.js           # æ’ä»¶å…¥å£
â”œâ”€â”€ icon.png           # æ’ä»¶å›¾æ ‡ (å»ºè®® 256x256)
â”œâ”€â”€ README.md          # è¯´æ˜æ–‡æ¡£
â”œâ”€â”€ src/               # æºä»£ç ç›®å½•
â”‚   â”œâ”€â”€ api.js
â”‚   â””â”€â”€ utils.js
â””â”€â”€ assets/            # èµ„æºæ–‡ä»¶
    â”œâ”€â”€ images/
    â””â”€â”€ styles/
```

---

## ğŸ”§ æ’ä»¶æ¨¡æ¿

é¡¹ç›®åŒ…å«ä¸€ä¸ªæ’ä»¶æ¨¡æ¿ä¾›å‚è€ƒ:

**ä½ç½®**: `plugins/plugin-template/`

æ‚¨å¯ä»¥ä½¿ç”¨è¿™ä¸ªæ¨¡æ¿ä½œä¸ºèµ·ç‚¹:

```bash
# å¤åˆ¶æ¨¡æ¿
cp -r rokun-tool/plugins/plugin-template rokun-tool/plugins/my-plugin

# ä¿®æ”¹ package.json
cd rokun-tool/plugins/my-plugin
# ç¼–è¾‘ package.json,ä¿®æ”¹æ’ä»¶IDå’Œåç§°

# å®ç°æ’ä»¶åŠŸèƒ½
# ç¼–è¾‘ index.js

# é‡å¯åº”ç”¨æµ‹è¯•
cd ../..
pnpm dev
```

---

## ğŸ“š æ›´å¤šèµ„æº

- **æ’ä»¶å¼€å‘æ–‡æ¡£**: `[å¾…è¡¥å……]`
- **API å‚è€ƒ**: `[å¾…è¡¥å……]`
- **ç¤ºä¾‹æ’ä»¶**: `plugins/rime-config/`, `plugins/wechat-multi-instance/`

---

## ğŸ’¡ æ€»ç»“

### å½“å‰æœºåˆ¶

âœ… **ç®€å•**: åªéœ€å°†æ’ä»¶æ”¾å…¥ `plugins/` ç›®å½•
âœ… **è‡ªåŠ¨**: åº”ç”¨å¯åŠ¨æ—¶è‡ªåŠ¨åŠ è½½
âœ… **é€æ˜**: åŠ è½½è¿‡ç¨‹åœ¨æ§åˆ¶å°å¯è§
âœ… **å®‰å…¨**: æƒé™æ²™ç®±ä¿æŠ¤ç³»ç»Ÿ

### æœªæ¥æ”¹è¿› (å¯é€‰)

â³ **æ’ä»¶å¸‚åœº**: åœ¨çº¿æµè§ˆå’Œå®‰è£…æ’ä»¶
â³ **è‡ªåŠ¨æ›´æ–°**: æ’ä»¶è‡ªåŠ¨æ£€æŸ¥å’Œæ›´æ–°
â³ **çƒ­é‡è½½**: æ— éœ€é‡å¯å³å¯åŠ è½½æ–°æ’ä»¶
â³ **UI ç®¡ç†**: åœ¨åº”ç”¨å†…å¯ç”¨/ç¦ç”¨æ’ä»¶

---

**æ–‡æ¡£ç‰ˆæœ¬**: 1.0.0
**æœ€åæ›´æ–°**: 2026-01-11
**ç»´æŠ¤è€…**: RokunTool Team
